import hashlib,sqlite3 def h(p):return hashlib.sha256(p.encode()).hexdigest() def c(u,p): conn=sqlite3.connect("password_manager.db");c=conn.cursor() c.execute("""CREATE TABLE IF NOT EXISTS accounts (username text PRIMARY KEY,password text)""") c.execute("""INSERT OR IGNORE INTO accounts (username, password) VALUES (?,?)""",(u,h(p))) conn.commit();conn.close();print("Account created!") def l(u,p): conn=sqlite3.connect("password_manager.db");c=conn.cursor() c.execute("""SELECT password FROM accounts WHERE username=?""",(u,)) s=c.fetchone();conn.close();return s and s[0]==h(p) def main(): c("johndoe","password123") r=l("johndoe","password123");print("Login Successful!"if r else"Login Failed.") r=l("johndoe","incorrectpassword");print("Login Successful!"if r else"Login Failed.") if __name__ == "__main__": main()
